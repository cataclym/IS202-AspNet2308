@model Kartverket.Models.HomePageModel

<!DOCTYPE html>
<html>
<body>
    <h1 class="header1 display-4">Min <span class="highlight">Side</span></h1>

    <div class="homepage">
        <div class="meld-kartfeil">
            <p>Finner du feil i kartet? Trykk her:</p>
            <div class="center-horizontal" style="text-decoration: none">
                <form asp-action="MapReport" method="post">
                    <button type="submit" class="btn-general btn-primary">Meld feil</button>
                </form>
            </div>

            <div class="password-change">
                <!-- Button to show password change form -->
                <button id="showPasswordFormBtn" class="btn-general btn-primary">Endre passord</button>

                <!-- Hidden form for changing password -->
                <div id="passwordForm" style="display: none; margin-top: 10px;">
                    <form asp-controller="Account" asp-action="ChangePassword" method="post">
                        <div class="change-password-container">
                            <label for="currentPassword">Nåværende passord:</label>
                            <input type="password" id="currentPassword" name="currentPassword" required>
                        </div>
                        <div>
                            <label for="newPassword">Nytt passord:</label>
                            <input type="password" id="newPassword" name="newPassword" class="new-password-input" required>
                            <button type="button" id="toggleNewPasswordBtn">Vis passord</button>
                        </div>
                        <div>
                            <label for="confirmPassword">Bekreft nytt passord:</label>
                            <input type="password" id="confirmPassword" name="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn-general btn-primary btn-move">Lagre nytt passord</button>
                    </form>
                </div>
            </div>
            <div>
                <form asp-controller="Account" asp-action="Logout" method="post">
                    <button type="submit" class="btn-general btn-primary">Logg ut</button>
                </form>
            </div>
        </div>

        
        
        <div class="user-information">
            @if (Model != null)
            {
            <table class="user-info-table">

                <tr class="user-table-header">

                    <th colspan="3" style="text-align: left;" class="user-table-header">Min informasjon:</th> <!-- Overskrift for tabell -->
                </tr>

                <tr>
                    <td><strong>Brukernavn:</strong></td>
                    <td>@Model.User.Username</td>
                </tr>
                <tr>
                    <td><strong>E-post:</strong></td>
                    <td>@Model.User.Email</td>
                </tr>
                <tr>
                    <td><strong>Telefonnummer:</strong></td>
                    <td>@Model.User.Phone</td>
                </tr>
            </table>
            }
        </div>

    <div>
        <table class="user-info-table">
                
            <!-- Table header row for column names -->
            <thead>
            <tr>
                <th>Rapport ID</th>
                <th>Melding</th>
                <th>Status</th>
                <th>Oprettet</th>
            </tr>
            </thead>

            <!-- Table body for reports data -->
            <tbody>
            @if (Model.Reports != null && Model.Reports.Any())
            {
                @foreach (var report in Model.Reports)
                {
                    <tr>
                        <td><a asp-action="ReportView" asp-controller="Home" asp-route-id="@report.ReportId">@report.ReportId</a></td>
                        <td class="truncate-text" title="@report.Message">@report.Message</td>
                        <td>@report.Status.ToString()</td>
                        <td>@report.CreatedAt.ToString()</td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="3">No reports available.</td>
                </tr>
            }
            </tbody>
        </table>
    </div>
    </div>

    
    <script>
        // JavaScript to toggle password visibility
        const passwordField = document.getElementById("passwordField");
        const togglePasswordBtn = document.getElementById("togglePasswordBtn");

        if (passwordField && togglePasswordBtn) {
            togglePasswordBtn.addEventListener("click", function () {
                if (passwordField.type === "password") {
                    passwordField.type = "text";  // Show password
                    togglePasswordBtn.textContent = "Skjul passord";  // Change button text
                } else {
                    passwordField.type = "password";  // Hide password
                    togglePasswordBtn.textContent = "Vis passord";  // Reset button text
                }
            });
        }

            // JavaScript to toggle password form visibility
            const showPasswordFormBtn = document.getElementById("showPasswordFormBtn");
            const passwordForm = document.getElementById("passwordForm");

            if (showPasswordFormBtn && passwordForm) {
                showPasswordFormBtn.addEventListener("click", function () {
                    // Toggle password form visibility
                    passwordForm.style.display = passwordForm.style.display === "none" ? "block" : "none";
                });
            }

              // JavaScript to toggle new password visibility
            const newPasswordField = document.getElementById("newPassword");
            const toggleNewPasswordBtn = document.getElementById("toggleNewPasswordBtn");

            if (newPasswordField && toggleNewPasswordBtn) {
                toggleNewPasswordBtn.addEventListener("click", function () {
                    if (newPasswordField.type === "password") {
                        newPasswordField.type = "text";  // Show new password
                        toggleNewPasswordBtn.textContent = "Skjul passord";  // Change button text
                    } else {
                        newPasswordField.type = "password";  // Hide new password
                        toggleNewPasswordBtn.textContent = "Vis passord";  // Reset button text
                    }
                });
            }

    </script>
</body>
</html>
